<nav class="navbar">
    <div class="navbar-brand">
        <a routerLink="/" class="logo">üìä Project Tracker</a>
    </div>

    <div class="navbar-menu" *ngIf="authService.isAuthenticated()">
        <a routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
        <a routerLink="/projects" routerLinkActive="active">Projects</a>
        <a routerLink="/my-tasks" routerLinkActive="active">My Tasks</a>

        <div class="session-timer" *ngIf="authService.timeRemaining$ | async as remainingTime"
            [class.warning]="authService.showExtendPrompt$ | async">
            <span>‚è≥ {{ remainingTime }}</span>
        </div>

        <div class="user-menu">
            <button class="user-button" (click)="toggleUserMenu()">
                <span class="user-avatar">{{ getUserInitials() }}</span>
                <span class="user-name">{{ getUserName() }}</span>
                <span class="dropdown-arrow">‚ñº</span>
            </button>

            <div class="user-dropdown" *ngIf="showUserMenu">
                <div class="dropdown-header">
                    <p class="user-email">{{ authService.getUser()?.email }}</p>
                    <p class="user-role" *ngIf="authService.isAdmin()"
                        style="font-size: 0.75rem; color: #f59e0b; font-weight: 600; margin-top: 0.25rem;">ADMIN</p>
                </div>
                <button class="dropdown-item" (click)="logout()">
                    <svg class="logout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                        <polyline points="16 17 21 12 16 7"></polyline>
                        <line x1="21" y1="12" x2="9" y2="12"></line>
                    </svg>
                    Logout
                </button>
            </div>
        </div>
    </div>

    <div class="navbar-menu" *ngIf="!authService.isAuthenticated()">
        <a routerLink="/login" routerLinkActive="active">Login</a>
        <a routerLink="/register" routerLinkActive="active">Register</a>
    </div>
</nav>

<div class="extend-session-overlay" *ngIf="showExtendPrompt && authService.isAuthenticated()">
    <div class="extend-session-modal">
        <div class="modal-icon">‚ö†Ô∏è</div>
        <h3>Session Expiring Soon</h3>
        <p>Your session will expire in <strong>{{ remainingTime }}</strong> due to inactivity.</p>
        <p class="modal-subtitle">Would you like to extend your session?</p>
        <div class="modal-actions">
            <button class="btn-extend" (click)="extendSession()">
                <span>üîÑ</span> Extend Session
            </button>
            <button class="btn-logout" (click)="logout()">
                <svg class="logout-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
                Logout Now
            </button>
        </div>
    </div>
</div>